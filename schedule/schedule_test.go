package schedule

import (
	"testing"
)

func CheckActual(actual []uint32, output []uint32, size int, t *testing.T) {
	if len(actual) != size {
		t.Fatalf("Unexpected length of %d when expected %d", len(actual), size)
	}

	for i := 0; i < size; i++ {
		if output[i] == actual[i] {
			continue
		} else {
			t.Logf("%d: %d == %d", i, output[i], actual[i])
			t.Errorf("Output%d is not matching", size)
		}
	}

}

func TestKeySchedule(t *testing.T) {
	output144 := [144]uint32{4, 32, 448, 32, 24576, 32, 16, 320, 29696, 320, 50397184, 320, 56, 2752, 1903616, 2752, 134414360, 2752, 176, 22528, 121839616, 22528, 403226688, 22528, 384, 180480, 3502772225, 180480, 1174798528, 180480, 896, 1444864, 839139444, 1444864, 806748720, 1444864, 2176, 11561984, 2165366028, 11561984, 2957083008, 11561984, 5376, 92504064, 1144603424, 92504064, 210503042, 92504064, 11264, 740036608, 240240657, 740036608, 1617694820, 740036608, 24576, 1625341953, 2490762307, 1625341953, 1635984131, 1625341953, 55296, 117882891, 495784165, 117882891, 471341836, 117882891, 126976, 943194200, 1667512647, 943194200, 3369623776, 943194200, 262144, 3250651841, 3642642904, 3250651841, 3339126342, 3250651841, 557056, 235673102, 1205106230, 235673102, 1211250232, 235673102, 1212416, 1886171248, 4124937617, 1886171248, 3249652289, 1886171248, 2686976, 2206565251, 2036556925, 2206565251, 236064270, 2206565251, 5505024, 473701404, 1507401566, 473701404, 3497029744, 473701404, 11534336, 3793805536, 2051528598, 3793805536, 2206434948, 3793805536, 24641536, 298256135, 2650138014, 298256135, 473179167, 298256135, 53477376, 2419603512, 2641979303, 2419603512, 2703292649, 2419603512, 109051904, 2193736132, 1851386343, 2193736132, 130501901, 2193736132, 226492416, 437128740, 3598350811, 437128740, 979920974, 437128740, 478150656, 3698356512, 1587443446, 3698356512, 1128428035, 3698356512, 1023410176, 58951943, 2812132761, 58951943, 328211098, 58951943}
	output168 := [168]uint32{4, 32, 448, 24576, 172032, 4980736, 10, 80, 1216, 73728, 565248, 17563648, 26, 208, 3264, 204800, 1613824, 51118080, 66, 528, 8384, 532480, 4235264, 135004160, 162, 1296, 20672, 1318912, 10526720, 336330752, 386, 3088, 49344, 3153920, 25206784, 806092800, 130, 1040, 16576, 1056768, 8429568, 269221888, 514, 4112, 65728, 4202496, 33595392, 1074528256, 1538, 12304, 196800, 12591104, 100704256, 3222011904, 4098, 32784, 524480, 33562624, 268476416, 786434, 10242, 81936, 1310912, 83894272, 671129600, 786437, 24578, 196624, 3145920, 201334784, 1610653696, 786444, 8194, 65552, 1048768, 67117056, 536911872, 786436, 32770, 262160, 4194496, 268443648, 2147524608, 786448, 98306, 786448, 12583104, 805314560, 2147524609, 786480, 262146, 2097168, 33554624, 2147491840, 40964, 786560, 655362, 5242896, 83886272, 1073750017, 40970, 786752, 1572866, 12582928, 201326784, 8195, 40984, 787200, 524290, 4194320, 67109056, 8193, 40968, 786688, 2097154, 16777232, 268435648, 8196, 40992, 787456, 6291458, 50331664, 805306560, 8204, 41056, 789504, 16777218, 134217744, 2147483840, 8224, 41216, 794624, 41943042, 335544336, 1073742017, 8272, 41600, 806912, 100663298, 805306384, 195, 8384, 42496, 835584, 33554434, 268435472, 193, 8256, 41472, 802816, 134217730, 1073741840, 196, 8448, 43008, 851968, 402653186, 3221225488, 204, 8960, 47104, 851968, 1073741826, 18, 224, 8192, 40960, 786432}
	output192 := [192]uint32{4, 32, 448, 24576, 172032, 4980736, 22, 128, 1088, 69632, 548864, 17301504, 34, 240, 3520, 212992, 1581056, 50593792, 70, 544, 8512, 536576, 4251648, 135266304, 162, 1296, 20672, 1318912, 10526720, 336330752, 398, 3136, 49216, 3149824, 25190400, 805830656, 906, 7216, 115136, 7356416, 58728448, 1879310336, 2054, 16416, 262464, 16789504, 134275072, 1048577, 514, 4112, 65728, 4202496, 33595392, 1074528256, 2062, 16448, 262208, 16781312, 134242304, 524289, 6154, 49200, 786880, 50348032, 402661376, 262147, 16390, 131104, 2097472, 134230016, 1073799168, 1048584, 40962, 327696, 5243072, 335552512, 2684395520, 786452, 98318, 786496, 12582976, 805310464, 2147508225, 524336, 229386, 1835056, 29360576, 1879064576, 2147491843, 262256, 524294, 4194336, 67109184, 12289, 57352, 1048832, 131074, 1048592, 16777408, 1073750016, 40962, 786496, 524302, 4194368, 67108928, 4097, 24584, 524544, 1572874, 12582960, 201327040, 16387, 8216, 262912, 4194310, 33554464, 536871232, 12296, 57408, 1050624, 10485762, 83886096, 1342177472, 8212, 41120, 791552, 25165838, 201326656, 3221225536, 4144, 24960, 536576, 58720266, 469762096, 3221225921, 16496, 9088, 290816, 134217734, 1073741856, 324, 12544, 59392, 1114112, 33554434, 268435472, 193, 8256, 41472, 802816, 134217742, 1073741888, 68, 4352, 26624, 589824, 402653194, 3221225520, 460, 17152, 14336, 327680, 1073741830, 34, 352, 12288, 57344, 1048576, 2684354562, 21, 208, 9216, 40960, 786432, 2147483663, 68, 64, 4096, 24576, 524288, 2147483659, 52, 448, 16384, 8192, 262144, 6, 32, 320, 12288, 57344, 1048576}

	key := [8]uint32{1, 2, 3, 4, 5, 6, 7, 8}

	actual144 := KeySchedule(128, key[:], key[:])
	CheckActual(actual144, output144[:], 144, t)

	actual168 := KeySchedule(192, key[:], key[:])
	CheckActual(actual168, output168[:], 168, t)

	actual192 := KeySchedule(256, key[:], key[:])
	CheckActual(actual192, output192[:], 192, t)

}

func TestSchedule128(t *testing.T) {
	output := [144]uint32{4, 32, 448, 32, 24576, 32, 16, 320, 29696, 320, 50397184, 320, 56, 2752, 1903616, 2752, 134414360, 2752, 176, 22528, 121839616, 22528, 403226688, 22528, 384, 180480, 3502772225, 180480, 1174798528, 180480, 896, 1444864, 839139444, 1444864, 806748720, 1444864, 2176, 11561984, 2165366028, 11561984, 2957083008, 11561984, 5376, 92504064, 1144603424, 92504064, 210503042, 92504064, 11264, 740036608, 240240657, 740036608, 1617694820, 740036608, 24576, 1625341953, 2490762307, 1625341953, 1635984131, 1625341953, 55296, 117882891, 495784165, 117882891, 471341836, 117882891, 126976, 943194200, 1667512647, 943194200, 3369623776, 943194200, 262144, 3250651841, 3642642904, 3250651841, 3339126342, 3250651841, 557056, 235673102, 1205106230, 235673102, 1211250232, 235673102, 1212416, 1886171248, 4124937617, 1886171248, 3249652289, 1886171248, 2686976, 2206565251, 2036556925, 2206565251, 236064270, 2206565251, 5505024, 473701404, 1507401566, 473701404, 3497029744, 473701404, 11534336, 3793805536, 2051528598, 3793805536, 2206434948, 3793805536, 24641536, 298256135, 2650138014, 298256135, 473179167, 298256135, 53477376, 2419603512, 2641979303, 2419603512, 2703292649, 2419603512, 109051904, 2193736132, 1851386343, 2193736132, 130501901, 2193736132, 226492416, 437128740, 3598350811, 437128740, 979920974, 437128740, 478150656, 3698356512, 1587443446, 3698356512, 1128428035, 3698356512, 1023410176, 58951943, 2812132761, 58951943, 328211098, 58951943}
	key := [4]uint32{1, 2, 3, 4}

	actual := Schedule128(key, key)

	CheckActual(actual[:], output[:], 144, t)	
}

func TestSchedule192(t *testing.T) {
	output := [168]uint32{4, 32, 448, 24576, 172032, 4980736, 10, 80, 1216, 73728, 565248, 17563648, 26, 208, 3264, 204800, 1613824, 51118080, 66, 528, 8384, 532480, 4235264, 135004160, 162, 1296, 20672, 1318912, 10526720, 336330752, 386, 3088, 49344, 3153920, 25206784, 806092800, 130, 1040, 16576, 1056768, 8429568, 269221888, 514, 4112, 65728, 4202496, 33595392, 1074528256, 1538, 12304, 196800, 12591104, 100704256, 3222011904, 4098, 32784, 524480, 33562624, 268476416, 786434, 10242, 81936, 1310912, 83894272, 671129600, 786437, 24578, 196624, 3145920, 201334784, 1610653696, 786444, 8194, 65552, 1048768, 67117056, 536911872, 786436, 32770, 262160, 4194496, 268443648, 2147524608, 786448, 98306, 786448, 12583104, 805314560, 2147524609, 786480, 262146, 2097168, 33554624, 2147491840, 40964, 786560, 655362, 5242896, 83886272, 1073750017, 40970, 786752, 1572866, 12582928, 201326784, 8195, 40984, 787200, 524290, 4194320, 67109056, 8193, 40968, 786688, 2097154, 16777232, 268435648, 8196, 40992, 787456, 6291458, 50331664, 805306560, 8204, 41056, 789504, 16777218, 134217744, 2147483840, 8224, 41216, 794624, 41943042, 335544336, 1073742017, 8272, 41600, 806912, 100663298, 805306384, 195, 8384, 42496, 835584, 33554434, 268435472, 193, 8256, 41472, 802816, 134217730, 1073741840, 196, 8448, 43008, 851968, 402653186, 3221225488, 204, 8960, 47104, 851968, 1073741826, 18, 224, 8192, 40960, 786432}

	key := [6]uint32{1, 2, 3, 4, 5, 6}

	actual := Schedule192(key, key)

	
	CheckActual(actual[:], output[:], 168, t)
}	


func TestSchedule256(t *testing.T) {
	output := [192]uint32{4, 32, 448, 24576, 172032, 4980736, 22, 128, 1088, 69632, 548864, 17301504, 34, 240, 3520, 212992, 1581056, 50593792, 70, 544, 8512, 536576, 4251648, 135266304, 162, 1296, 20672, 1318912, 10526720, 336330752, 398, 3136, 49216, 3149824, 25190400, 805830656, 906, 7216, 115136, 7356416, 58728448, 1879310336, 2054, 16416, 262464, 16789504, 134275072, 1048577, 514, 4112, 65728, 4202496, 33595392, 1074528256, 2062, 16448, 262208, 16781312, 134242304, 524289, 6154, 49200, 786880, 50348032, 402661376, 262147, 16390, 131104, 2097472, 134230016, 1073799168, 1048584, 40962, 327696, 5243072, 335552512, 2684395520, 786452, 98318, 786496, 12582976, 805310464, 2147508225, 524336, 229386, 1835056, 29360576, 1879064576, 2147491843, 262256, 524294, 4194336, 67109184, 12289, 57352, 1048832, 131074, 1048592, 16777408, 1073750016, 40962, 786496, 524302, 4194368, 67108928, 4097, 24584, 524544, 1572874, 12582960, 201327040, 16387, 8216, 262912, 4194310, 33554464, 536871232, 12296, 57408, 1050624, 10485762, 83886096, 1342177472, 8212, 41120, 791552, 25165838, 201326656, 3221225536, 4144, 24960, 536576, 58720266, 469762096, 3221225921, 16496, 9088, 290816, 134217734, 1073741856, 324, 12544, 59392, 1114112, 33554434, 268435472, 193, 8256, 41472, 802816, 134217742, 1073741888, 68, 4352, 26624, 589824, 402653194, 3221225520, 460, 17152, 14336, 327680, 1073741830, 34, 352, 12288, 57344, 1048576, 2684354562, 21, 208, 9216, 40960, 786432, 2147483663, 68, 64, 4096, 24576, 524288, 2147483659, 52, 448, 16384, 8192, 262144, 6, 32, 320, 12288, 57344, 1048576}

	key := [8]uint32{1, 2, 3, 4, 5, 6, 7, 8}

	actual := Schedule256(key, key)

	
	CheckActual(actual[:], output[:], 192, t)

}
